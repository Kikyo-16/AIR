(function(){"use strict";var e={9600:function(e,s,a){var t=a(9242),i=a(3396);const r=e=>((0,i.dD)("data-v-9d94bcd0"),e=e(),(0,i.Cn)(),e),l={id:"app",style:{"background-color":"#ffffff"}},n=(0,i.uE)('<h1 class="title" data-v-9d94bcd0>Arrange, Inpaint, and Refine: Steerable Long-term Music Audio Generation and Editing via Content-based Controls</h1><div class="author" data-v-9d94bcd0> Liwei Lin, Gus Xia, Yixiao Zhang, Junyan Jiang @<a href="http://www.musicxlab.com/" data-v-9d94bcd0>Music X Lab</a></div><div class="card" data-v-9d94bcd0><div class="sub-sec" data-v-9d94bcd0> We introduce a novel Parameter-Efficient Fine-Tuning (PEFT) method, enabling autoregressive language models to seamlessly address music inpainting tasks. Our experiments on <a href="https://arxiv.org/abs/2306.05284" data-v-9d94bcd0>MusicGen</a> demonstrate promising results across multiple music editing tasks, offering more flexible controls for future AI-driven music editing tools. See more details in our <a href="https://arxiv.org/pdf/2402.09508.pdf" data-v-9d94bcd0>paper</a> and try our model via <a href="https://github.com/Kikyo-16/airgen" data-v-9d94bcd0>github</a>. </div></div>',3),d={class:"card"},o={class:"sub-sec"},u=r((()=>(0,i._)("h3",null," Inpianting ",-1))),h=r((()=>(0,i._)("br",null,null,-1))),c={class:"radio-group"},f=["onchange"],_=r((()=>(0,i._)("label",{for:"sec_1_mask_1"},"Mask 1",-1))),g={class:"radio-group"},p=["onchange"],m=r((()=>(0,i._)("label",{for:"sec_1_mask_2"},"Mask 2",-1))),v=r((()=>(0,i._)("br",null,null,-1))),y={ref:"sec_1_audio_mask_1_div"},k={ref:"sec_1_audio_mask_2_div",hidden:""},b={class:"card"},$={class:"sub-sec"},w=r((()=>(0,i._)("h3",null," OOD Test ",-1))),x=r((()=>(0,i._)("br",null,null,-1))),C={class:"radio-group"},A=["onchange"],T=r((()=>(0,i._)("label",{for:"sec_2_mask_1"},"Mask 1",-1))),S={class:"radio-group"},M=["onchange"],R=r((()=>(0,i._)("label",{for:"sec_2_mask_2"},"Mask 2",-1))),D=r((()=>(0,i._)("br",null,null,-1))),P={ref:"sec_2_audio_mask_1_div"},B={ref:"sec_2_audio_mask_2_div",hidden:""};function j(e,s,a,t,r,j){const O=(0,i.up)("AudioGroup");return(0,i.wg)(),(0,i.iD)("div",l,[n,(0,i._)("div",d,[(0,i._)("div",o,[u,(0,i.Uk)(" The gray blocks denote regions designated for inpainting. Note that musicgen operates as an autoregressive model, for which only continuation samples are placed here, rather than being subjected to inpainting. "),h,(0,i._)("div",null,[(0,i._)("div",c,[(0,i._)("input",{type:"radio",ref:"sec_1_mask_1",id:"sec_1_mask_1",name:"sec_1",value:"mask_1",checked:"checked",onchange:j.sec1Changed},null,8,f),_]),(0,i._)("div",g,[(0,i._)("input",{type:"radio",ref:"sec_1_mask_2",id:"sec_1_mask_2",name:"sec_1",value:"mask_2",onchange:j.sec1Changed},null,8,p),m])]),v]),(0,i._)("div",y,[(0,i.Wm)(O,{ref:"sec_1_audio_mask_1",idx:0,jdx:10,kdx:5,mask_id:0},null,512)],512),(0,i._)("div",k,[(0,i.Wm)(O,{ref:"sec_1_audio_mask_2",idx:0,jdx:10,kdx:5,mask_id:1},null,512)],512)]),(0,i._)("div",b,[(0,i._)("div",$,[w,(0,i.Uk)(" The given context includes vocal harmonies. "),x,(0,i._)("div",null,[(0,i._)("div",C,[(0,i._)("input",{type:"radio",ref:"sec_2_mask_1",id:"sec_2_mask_1",name:"sec_2",value:"mask_1",checked:"checked",onchange:j.sec2Changed},null,8,A),T]),(0,i._)("div",S,[(0,i._)("input",{type:"radio",ref:"sec_2_mask_2",id:"sec_2_mask_2",name:"sec_2",value:"mask_2",onchange:j.sec2Changed},null,8,M),R])]),D]),(0,i._)("div",P,[(0,i.Wm)(O,{ref:"sec_2_audio_mask_1",idx:1,jdx:5,kdx:5,mask_id:0},null,512)],512),(0,i._)("div",B,[(0,i.Wm)(O,{ref:"sec_2_audio_mask_2",idx:1,jdx:5,kdx:5,mask_id:1},null,512)],512)])])}var O=a(7139);const G=e=>((0,i.dD)("data-v-3daa439a"),e=e(),(0,i.Cn)(),e),I={class:"audio-bar"},F={class:"audio-bar"},N=G((()=>(0,i._)("div",{class:"sample-name"},null,-1))),E={class:"desc",ref:"desc1"},W={class:"desc",ref:"desc2"},Z={class:"desc",ref:"desc3"},q={class:"desc",ref:"desc4"},z={class:"desc",ref:"desc5"},L={class:"audio-bar"};function Y(e,s,a,t,r,l){const n=(0,i.up)("my-canvas"),d=(0,i.up)("my-audio");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",I,[(0,i.Wm)(n,{class:"canvas",ref:"myCanvas",audioTag:"111",onPauseAudio:l.pauseTarget,onPlayAudio:l.playTarget},null,8,["onPauseAudio","onPlayAudio"])]),(0,i._)("div",F,[N,(0,i._)("div",E,"VampNet",512),(0,i._)("div",W,"MusicGen",512),(0,i._)("div",Z,"Drums-AIR",512),(0,i._)("div",q,"Chord-AIR",512),(0,i._)("div",z,"Piano-AIR",512)]),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.jdx,(e=>((0,i.wg)(),(0,i.iD)("div",{key:e},[(0,i._)("div",L,[(0,i._)("div",{class:"sample-name",ref_for:!0,ref:"sample"+e},(0,O.zw)("Sample "+("00"+e).slice(-3)),513),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.kdx,(s=>((0,i.wg)(),(0,i.j4)(d,{class:"audio",musicSrc:a.audioSrc[a.idx][e-1][a.mask_id][s-1],audioTag:[e,s],ref_for:!0,ref:""+e+s,onPlay:a=>l.updateAttrs(e,s),onTimeupdate:l.updateCanvas,key:""+e+s},null,8,["musicSrc","audioTag","onPlay","onTimeupdate"])))),128))])])))),128))],64)}a(7658);const H=["src"];function K(e,s,a,t,r,l){return(0,i.wg)(),(0,i.iD)("audio",{ref:"player",src:a.musicSrc,controls:"",preload:"auto",onPlay:s[0]||(s[0]=e=>l.play())},null,40,H)}var X={name:"MyAudio",props:{musicSrc:{type:String,require:!0},audioTag:{type:Array,require:!0}},watch(){},data(){return{}},mounted(){let e=this;setInterval((function(){e.timeupdate()}),10)},methods:{play(){this.$emit("play")},getProgress(){return null===this.$refs.player?[0,0,1]:[this.$refs.player.currentTime/this.$refs.player.duration,this.$refs.player.currentTime,this.$refs.player.duration]},timeupdate(){null===this.$refs.player||this.$refs.player.paused||this.$emit("timeupdate",this.getProgress(),this.audioTag)},pause(){null===this.$refs.player||this.$refs.player.paused||this.$refs.player.pause()},continue(e){null!==this.$refs.player&&(this.$refs.player.paused||this.$refs.player.pause(),this.$refs.player.currentTime=e*this.$refs.player.duration,this.$refs.player.play())}}},J=a(89);const U=(0,J.Z)(X,[["render",K]]);var V=U;const Q={style:{position:"relative"}},ee={ref:"layer2",width:"1600",height:"200",style:{position:"absolute",width:"100%",height:"120px","z-index":"2"}},se={ref:"layer3",width:"1600",height:"200",style:{position:"absolute",width:"100%",height:"120px","z-index":"1"}};function ae(e,s,a,t,r,l){return(0,i.wg)(),(0,i.iD)("div",Q,[(0,i._)("canvas",{ref:"layer1",width:"1600",height:"200",onMousemove:s[0]||(s[0]=(...e)=>l.mousemove&&l.mousemove(...e)),onMouseleave:s[1]||(s[1]=(...e)=>l.mouseleave&&l.mouseleave(...e)),onMousedown:s[2]||(s[2]=(...e)=>l.mousedown&&l.mousedown(...e)),onMouseup:s[3]||(s[3]=(...e)=>l.mouseup&&l.mouseup(...e)),style:{position:"absolute",width:"100%",height:"120px","z-index":"3"}},null,544),(0,i._)("canvas",ee,null,512),(0,i._)("canvas",se,null,512)])}function te(e,s){return"C"===e?"rgba(255,0,0, 0.3)":"C#"===e?"rgba(255,150,50,0.3)":"D"===e?"rgba(255,145,0,0.3)":"D#"===e||"Eb"===e?"rgba(255,242,0,0.3)":"E"===e?"rgb(0,128,0,0.3)":"F"===e?"rgba(0,255,217,0.3)":"F#"===e?"rgba(0,178,255,0.3)":"G"===e?"rgba(0,0,128,0.3)":"G#"===e?"rgba(34,0,255,0.3)":"A"===e?"rgba(94,0,255,0.3)":"A#"===e||"Bb"===e?"rgba(153,0,255,0.3)":"B#"===e?"rgba(247,0,255,0.3)":"rgba(220,220,220,0.3)"}function ie(e){return"N"===e[1]?22*e[0].length:22*e[0].length+16*e[1].length}function re(e){let s,a,t=Math.floor(e),i=Math.floor(60*(e-t));return s=t<10?"0"+t:""+t,a=i<10?"0"+i:""+i,s+" : "+a}var le={name:"MyCanvas",props:{chords:{type:Object,require:!0},audioTag:{type:String,require:!0}},data(){return{chordCanvas:null,pgCanvas:null,ratio:0,highlightBar:!1,redBar:!1,isDrag:!1,init:!1,globalInit:!1,audio:this.audioTag,selectedTags:["001/000","001/000"]}},mounted(){let e=this.$refs["layer2"],s=this.$refs["layer1"],a=this.$refs["layer3"];this.chordCanvas=e.getContext("2d"),this.pgCanvas=s.getContext("2d"),this.durCanvas=a.getContext("2d"),this.masks=[],this.mask_offset=0,this.updateCanvas(this.selectedTags[0],this.selectedTags[1],0,0,0,0,0,[],0)},methods:{updateCanvas(e,s,a,t,i,r,l,n,d){this.init&&(t=0,this.init=!1),this.selectedTags=[e,s],this.audio=i,this.cur=r,this.dur=l,this.masks=n,this.mask_offset=d,0===t&&(this.clearPG(),this.drawMask(n,l,d)),this.drawProgress(a,t),this.drawCurrentTime(r,l,a)},drawBackground(){},drawCurrentTime(e,s,a){let t=this.$refs["layer3"].width,i=this.$refs["layer3"].height,r=this.durCanvas,l=re(e),n=re(s),d=a*t,o=80;r.clearRect(d-2*o,i/2-30,4*o,40),r.font="22px Arial",r.fillStyle="black",r.textAlign="left top",r.fillText(l,d-o,i/2-10,o,10),r.fillText(n,d+10,i/2-10,o,10)},drawChords(e,s){let a=this.$refs["layer2"].width,t=this.$refs["layer2"].height,i=this.chordCanvas,r=this.chords[e],l=this.chords[s];i.clearRect(0,0,a,t),this.drawChordSegs(i,r,a,t,0),this.drawChordSegs(i,l,a,t,t/2+.5)},drawMask(e,s,a){let t=this.$refs["layer2"].width,i=this.$refs["layer2"].height,r=this.chordCanvas;r.clearRect(0,0,t,i),r.fillStyle="rgba(38,38,38,0.4)",r.fillRect(0,0,t,i);let l=te("F#","F#");0!==a&&(l=te("A","A")),a<0&&(a=0);for(let n=0;n<e.length;++n){let d=e[n],o=d[0]*t/s,u=d[1]*t/s-o;r.fillStyle=l,r.clearRect(o,0,u,i),r.fillRect(o,0,u,i),console.log(s,o,a,u),0!==a&&(r.fillStyle=te("F#","F#"),o+=a*t/s,r.clearRect(o,0,u,i),r.fillRect(o,0,u,i))}},drawChordSegs(e,s,a,t,i){let r=0,l=0,n=0,d=a;for(let o=0;o<s.length;++o){n=s[o][0]*a/1001,d=(s[o][1]-s[o][0])*a/1001,e.fillStyle=te(s[o][2],s[o][3]),e.fillRect(n,i+2,d,t/2-4),e.fillStyle="rgba(0, 0, 0, 0.2)",e.fillRect(n,i+2,5,t/2-4);let u=[s[o][2],s[o][3]];if(d>10&&n+2<r?(l+=25,this.drawTags(e,n,i+25+l,a,t/2,u)):d>10?(l=0,this.drawTags(e,n,i+25+l,a,t/2,u)):l=0,d>10){let e=ie(u);r=d>e?n+d:n+e}}},drawTags(e,s,a,t,i,r){e.font="22px Comic Sans MS",e.fillStyle="black",e.textAlign="left top",e.fillText(r[0],s+8,a,t,i),"N"!==r[1]&&(e.font="16px Comic Sans MS",1===r[0].length?e.fillText(r[1],s+23,a,t,i):e.fillText(r[1],s+40,a,t,i))},clearPG(){let e=this.$refs["layer1"].width,s=this.$refs["layer1"].height,a=this.pgCanvas;a.clearRect(0,0,e,s),a=this.durCanvas,a.clearRect(0,0,e,s)},drawProgress(e,s){let a=this.$refs["layer1"].width,t=this.$refs["layer1"].height,i=this.pgCanvas,r=16;s>0?(i.fillStyle="rgba(0,0,0,0.06)",i.clearRect(a*e-r,0,2*r,t),i.fillRect(a*e-r-2,0,r+2,t)):(i.fillStyle="rgba(0,0,0,0.3)",i.fillRect(0,0,a*e,t)),this.highlightBar?(i.fillStyle="rgba(255,0,0,0.8)",i.fillRect(a*e-8,0,16,t),i.fillStyle="rgba(255,255,255,0.8)",i.fillRect(a*e-5,0,10,t),this.redBar=!0):this.redBar=!1,i.beginPath(),i.strokeStyle="black",i.lineWidth=4,i.moveTo(a*e,0),i.lineTo(a*e,t),i.stroke(),i.closePath(),this.ratio=e},isActive(e){return Math.abs(this.getMouseRatio(e)-this.ratio)<.2},getMouseRatio(e){let s=this.$refs["layer1"].getBoundingClientRect();return(e.clientX-s.left)/(s.right-s.left)},setBarStatus(e){0===e?(this.highlightBar=!1,this.redBar&&this.drawProgress(this.ratio,1)):(this.highlightBar=!0,this.redBar||this.drawProgress(this.ratio,1))},mouseleave(e){this.isDrag,this.isDrag=!1,this.setBarStatus(0)},mousemove(e){if(this.isActive(e)?this.setBarStatus(1):this.setBarStatus(0),this.isDrag){let s=this.getMouseRatio(e);this.updateCanvas(this.selectedTags[0],this.selectedTags[1],s,0,this.audio,s*this.dur,this.dur,this.masks,this.mask_offset)}},mousedown(e){this.highlightBar&&(this.isDrag||this.$emit("pauseAudio",this.audio),this.isDrag=!0,this.init=!0)},mouseup(e){this.isDrag&&this.$emit("playAudio",[this.audio,this.ratio]),this.isDrag=!1}}};const ne=(0,J.Z)(le,[["render",ae]]);var de=ne;function oe(e,s){let a="./audio/",t=Array(0);for(let i=1;i<=2;++i){let r=Array(0);for(let t=1;t<=s;++t){let s=Array(0),l=a+e+i+"/"+("00"+t).slice(-3)+"/";for(let e=0;e<=1;++e){let a=Array(0);a.push(l+"vampnet_mask_"+e+"_full_0.wav"),a.push(l+"musicgen_mask_"+e+"_full_0.wav.wav"),a.push(l+"fix_drums_mask_"+e+"_full_0.wav"),a.push(l+"chord_mask_"+e+"_full_0.wav"),a.push(l+"piano_mask_"+e+"_full_0.wav"),s.push(a)}r.push(s)}t.push(r)}return t}var ue={name:"AudioGroup",components:{MyAudio:V,MyCanvas:de},props:{idx:{type:Number,default:1},jdx:{type:Number,default:3},kdx:{type:Number,default:3},mask_id:{type:Number,default:0},audioSrc:{type:Array,default:oe("sec",15)}},methods:{updateAttrs(e,s){this.reviseDiv(e,s);let a=""+e+s,t=this.$refs[a][0].getProgress();this.reviseCanvas(t[0],e,s,0,t[1],t[2]),this.pauseAll(a)},reviseDiv(e,s){this.$refs.myCanvas.globalInit=!0,this.$refs["desc"+s].style.background="rgba(255, 0, 0, 0.1)",this.$refs["sample"+e][0].style.background="rgba(255, 0, 0, 0.1)";for(let a=1;a<=this.kdx;a++)a!==s&&(this.$refs["desc"+a].style.background="rgba(255, 0, 0, 0)");for(let a=1;a<=this.jdx;a++)a!==e&&(this.$refs["sample"+a][0].style.background="rgba(255, 0, 0, 0)")},reviseCanvas(e,s,a,t,i,r){let l=""+s+a,n="00"+s+"/00"+(a-1),d="00"+s+"/000",o=Math.ceil(375),u=Math.ceil(o/2),h=Math.ceil(u/2);o=o/1501*15,u=u/1501*15,h=h/1501*15;let c=[[[0,o],[3*o,15]],[[0,u],[u+o,u+2*o],[u+3*o,15]],[[0,o]],[[0,u]]];2===a?this.$refs.myCanvas.updateCanvas(n,d,e,t,l,i,r,c[this.mask_id+2],-1):this.$refs.myCanvas.updateCanvas(n,d,e,t,l,i,r,c[this.mask_id],15)},updateCanvas(e,s){"number"===typeof e[0]&&this.reviseCanvas(e[0],s[0],s[1],1,e[1],e[2])},pauseTarget(e){void 0!==this.$refs[e]&&this.$refs[e][0].pause()},playTarget(e){void 0!==e[0]&&void 0!==this.$refs[e[0]]&&this.$refs[e[0]][0].continue(e[1])},pauseAll(e){for(let s=1;s<=this.jdx;s++)for(let a=1;a<=this.kdx;a++){let t=""+s+a;null!==e&&t===e||this.$refs[t][0].pause()}}}};const he=(0,J.Z)(ue,[["render",Y],["__scopeId","data-v-3daa439a"]]);var ce=he,fe={name:"App",components:{AudioGroup:ce},methods:{sec1Changed(){this.$refs.sec_1_mask_1.checked?(this.$refs.sec_1_audio_mask_1_div.hidden=!1,this.$refs.sec_1_audio_mask_2_div.hidden=!0,this.$refs.sec_1_audio_mask_2.pauseAll(null)):(this.$refs.sec_1_audio_mask_1_div.hidden=!0,this.$refs.sec_1_audio_mask_2_div.hidden=!1,this.$refs.sec_1_audio_mask_1.pauseAll(null))},sec2Changed(){this.$refs.sec_2_mask_1.checked?(this.$refs.sec_2_audio_mask_1_div.hidden=!1,this.$refs.sec_2_audio_mask_2_div.hidden=!0,this.$refs.sec_2_audio_mask_2.pauseAll(null)):(this.$refs.sec_2_audio_mask_1_div.hidden=!0,this.$refs.sec_2_audio_mask_2_div.hidden=!1,this.$refs.sec_2_audio_mask_1.pauseAll(null))}}};const _e=(0,J.Z)(fe,[["render",j],["__scopeId","data-v-9d94bcd0"]]);var ge=_e;const pe=(0,t.ri)(ge);pe.mount("#app")}},s={};function a(t){var i=s[t];if(void 0!==i)return i.exports;var r=s[t]={exports:{}};return e[t].call(r.exports,r,r.exports,a),r.exports}a.m=e,function(){var e=[];a.O=function(s,t,i,r){if(!t){var l=1/0;for(u=0;u<e.length;u++){t=e[u][0],i=e[u][1],r=e[u][2];for(var n=!0,d=0;d<t.length;d++)(!1&r||l>=r)&&Object.keys(a.O).every((function(e){return a.O[e](t[d])}))?t.splice(d--,1):(n=!1,r<l&&(l=r));if(n){e.splice(u--,1);var o=i();void 0!==o&&(s=o)}}return s}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[t,i,r]}}(),function(){a.n=function(e){var s=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(s,{a:s}),s}}(),function(){a.d=function(e,s){for(var t in s)a.o(s,t)&&!a.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:s[t]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)}}(),function(){var e={143:0};a.O.j=function(s){return 0===e[s]};var s=function(s,t){var i,r,l=t[0],n=t[1],d=t[2],o=0;if(l.some((function(s){return 0!==e[s]}))){for(i in n)a.o(n,i)&&(a.m[i]=n[i]);if(d)var u=d(a)}for(s&&s(t);o<l.length;o++)r=l[o],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(u)},t=self["webpackChunkAirGen"]=self["webpackChunkAirGen"]||[];t.forEach(s.bind(null,0)),t.push=s.bind(null,t.push.bind(t))}();var t=a.O(void 0,[998],(function(){return a(9600)}));t=a.O(t)})();
//# sourceMappingURL=app.fc1b4d0e.js.map